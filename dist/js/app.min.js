"use strict";var app=angular.module("app",["angular-loading-bar","ngAnimate","ui.router","toastr","ui.bootstrap"]).run(["$rootScope","$state","$timeout","$location",function(e,t,a,o){console.log(" start app"),e.isLogin=sessionStorage.isLogin;var n=o.search();"login"===n.tmethod&&a(function(){t.go("home.login")})}]);angular.module("app").config(["$httpProvider","toastrConfig","$locationProvider",function(e,t,a){e.interceptors.push("authorInterceptor"),a.html5Mode({enabled:!0,requireBase:!0}),angular.extend(t,{timeOut:2e3})}]),angular.module("app").controller("ListController",["$rootScope","$http","$location","$stateParams","$scope","toastr","$state",function(e,t,a,o,n,r,i){function s(){t({url:"getAllDocs",method:"POST"}).then(function(e){n.docs=e.data.model,l()},function(e){})}function l(){n.docs.forEach(function(e){t({url:"getDocument",method:"POST",data:{name:e.name}}).then(function(t){t.data.status?(n.apis=t.data.model.apis,e.apiList=c(n.apis)):r.warning(t.data.msg)})})}function c(e){for(var t=[],a=0;a<e.length;a++)t.push({idx:a,name:e[a].name});return t}n.docs=[],s(),n.logout=function(){t({url:"login/logout",method:"POST"}).then(function(t){sessionStorage.clear(),e.isLogin=sessionStorage.isLogin,i.go("home")})}}]).controller("MainController",["$http","$scope","$stateParams","toastr","$state","$uibModal",function(e,t,a,o,n,r){t.apis=[],e({url:"getDocument",method:"POST",data:{name:a.docName}}).then(function(e){e.data.status?(t.apis.push(e.data.model.apis[a.apiIndex]),t.documentInfo=e.data.model.docInfo,t.documentInfo.index=a.apiIndex):o.warning(e.data.msg)}),t.delApi=function(t,i){var s=r.open({animation:!0,templateUrl:"confirm.html",controller:"delDocumentCtl",keyboard:!1,backdrop:"static"});s.result.then(function(t){t?e({url:"delApi",method:"POST",data:{index:a.apiIndex,name:i}}).then(function(e){o.success(e.data.msg),n.transitionTo("home.doc",{docName:a.docName,apiIndex:0},{reload:!0})},function(e){o.warning(e.data.msg)}):console.log("dismiss")})}}]).controller("NewDocumentController",["$scope","$http","toastr","$state",function(e,t,a,o){e.newDocument=function(){t({url:"newDocument",method:"POST",data:e.newDocs}).then(function(e){e.data.status?(a.success(e.data.msg),o.transitionTo("home",{},{reload:!0})):a.warning(e.data)},function(e){})}}]).controller("AddApiController",["$scope","toastr","$stateParams","$http","$state",function(e,t,a,o,n){e.newApi={params:[],res:[],callbackParams:[]},e.docType=a.apiIndex,e.addApi=function(r){r.$valid?o({url:"addApi",method:"POST",data:{name:a.docName,body:e.newApi}}).then(function(e){e.data.status?(t.success(e.data.msg),n.transitionTo("home.doc",{docName:a.docName,apiIndex:0},{reload:!0})):t.warning(e.data.msg)}):t.warning("请把表单填完整后在提交")}}]).controller("delDocumentCtl",["$uibModalInstance","$scope","$stateParams",function(e,t,a){t.ok=function(){e.close(a.docName)},t.cancel=function(){e.dismiss()}}]).controller("editApiCtrl",["$scope","$http","toastr","$uibModal","$stateParams","$state",function(e,t,a,o,n,r){t({url:"getDocument",method:"POST",data:{name:n.docName}}).then(function(t){t.data.status?(e.apis=t.data.model.apis[n.apiIndex],e.documentInfo=t.data.model.docInfo):a.warning(t.data.msg)}),e.submitAdd=function(o){o.$valid?t({url:"editApi",method:"POST",data:{index:n.apiIndex,name:n.docName,api:e.apis}}).then(function(e){e.data.status?(a.success(e.data.msg),r.transitionTo("home.doc",{docName:n.docName,apiIndex:0},{reload:!0})):a.warning(e.data.msg)}):a.warning("请把表单填完整后在提交")}}]).controller("ErrorController",["$stateParams","$http","$scope",function(e,t,a){a.docname=e.docName,a.errors=[],t({url:"getDocument",method:"POST",data:{name:e.docName}}).then(function(e){e.data.status&&(a.errors=e.data.model.errorCodeLst||[])})}]).controller("EditErrController",["$stateParams","$http","toastr","$scope",function(e,t,a,o){t({url:"getDocument",method:"POST",data:{name:e.docName}}).then(function(e){e.data.status&&(o.errors=e.data.model.errorCodeLst||[])}),o.addErrs=function(){console.log(o.errors),t({url:"editErrorCode",method:"POST",data:{name:e.docName,body:o.errors}}).then(function(e){e.data.status?(a.success("res",e),history.go(-1)):a.warning("服务器异常")})}}]).controller("LoginController",["$scope","$http","$rootScope","toastr","$state",function(e,t,a,o,n){e.login=function(r){r.$valid?t({url:"login/checkLogin",data:e.user,method:"POST"}).then(function(e){e.data.status?(sessionStorage.setItem("isLogin",!0),a.isLogin=sessionStorage.isLogin,n.go("home")):o.warning(e.data.msg)}):o.warning("请输入完整登录信息")}}]),angular.module("app").directive("onFormReady",["$timeout",function(e){return{restrict:"A",link:function(e,t,a){e.addParams=function(t){var a={apiName:"",apiValue:"",type:"",require:"是",defaultValue:""};e.apis.params.push(a)},e.addRes=function(t){var a={key:"",revalue:"",type:"",require:"否"};e.apis.res.push(a)},e.delParam=function(t){e.apis.params.splice(t,1)},e.delRes=function(t){e.apis.res.splice(t,1)},e.addCallbackParam=function(t){console.log(t);var a={apiName:"",apiValue:"",type:"",require:"是",defaultValue:""};e.apis.callbackParams.push(a)},e.delCallbackParam=function(t){e.apis.callbackParams.splice(t,1)}}}}]).directive("onNewFormReady",["$timeout",function(e){return{restrict:"A",link:function(e,t,a){e.addParams=function(t){var a={apiName:"",apiValue:"",type:"",require:"是",defaultValue:""};e.newApi.params.push(a)},e.addRes=function(t){var a={key:"",revalue:"",type:"",require:"否"};e.newApi.res.push(a)},e.delParam=function(t){e.newApi.params.splice(t,1)},e.delRes=function(t){e.newApi.res.splice(t,1)},e.addCallbackParam=function(t){console.log(t);var a={apiName:"",apiValue:"",type:"",require:"是",defaultValue:""};e.newApi.callbackParams.push(a)},e.delCallbackParam=function(t){e.newApi.callbackParams.splice(t,1)}}}}]).directive("onErrReady",["$timeout",function(e){return{restrict:"A",link:function(e){e.addErr=function(){var t={name:"",res:"",description:""};e.errors.push(t)},e.delErr=function(t){console.log(e.errors)}}}}]),angular.module("app").filter("docType",function(){return function(e){switch(e){case"0":return"api";case"1":return"sdk"}}}),angular.module("app").config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("home",{url:"/",templateUrl:"src/page/list.html",controller:"ListController"}).state("home.doc",{url:":docName/:apiIndex",views:{apiContent:{templateUrl:"src/page/document.html",controller:"MainController"}}}).state("home.edit",{url:":docName/:apiIndex/edit",views:{apiContent:{templateUrl:"src/page/form.html",controller:"editApiCtrl"}}}).state("home.new",{url:"new",views:{"main-container":{templateUrl:"src/page/newDocument.html",controller:"NewDocumentController"}}}).state("home.login",{url:"login",views:{"main-container":{templateUrl:"src/page/login.html",controller:"LoginController"}}}).state("home.newApi",{url:":docName/:apiIndex/newApi",views:{apiContent:{templateUrl:"src/page/newApi.html",controller:"AddApiController"}}}).state("home.error",{url:":docName/:apiIndex/errCode",views:{apiContent:{templateUrl:"src/page/errorCode.html",controller:"ErrorController"}}}).state("home.editErr",{url:":docName/edit/err",views:{apiContent:{templateUrl:"src/page/errorForm.html",controller:"EditErrController"}}});t.otherwise("/")}]),angular.module("app").factory("authorInterceptor",["$log","$q","$rootScope","$location",function(e,t,a,o){var n={request:function(e){return e},response:function(e){return e||t.when(e)},responseError:function(e){return e}};return n}]);