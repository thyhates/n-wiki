"use strict";var app=angular.module("app",["ngAnimate","ui.router","toastr","schemaForm","ui.bootstrap"]).run(function(){console.log("start app")});angular.module("app").config(["$httpProvider","toastrConfig",function(t,e){t.interceptors.push("authorInterceptor"),angular.extend(e,{timeOut:2e3})}]),angular.module("app").controller("ListController",["$http","$anchorScroll","$location","$stateParams","$scope","toastr","$state","$uibModal",function(t,e,a,o,n,i,r,s){function d(){t({url:"getDocument",method:"POST",data:{name:o.docName}}).then(function(t){t.data.status?(n.apis=t.data.model.apis,n.documentInfo=t.data.model.docInfo,n.titles=c(n.apis)):i.warning(t.data.msg)})}function c(t){for(var e=[],a=0;a<t.length;a++)e.push({idx:a,name:t[a].name}),console.log(e);return console.log(e),e}n["goto"]=function(t){a.hash(t),e()},d(),n.addApi=function(){var t=s.open({animation:!0,templateUrl:"src/page/form.html",controller:"AddApiController",keyboard:!1,backdrop:"static"});t.result.then(function(t){d()},function(){})},n.deleteDoc=function(){var e=s.open({animation:!0,templateUrl:"confirm.html",controller:"delDocumentCtl",keyboard:!1,backdrop:"static"});e.result.then(function(e){e&&t({url:"delDocument",method:"POST",data:{name:o.docName}}).then(function(t){t.data.status?(i.success(t.data.msg),r.go("home")):i.warning(t.data.msg)})})},n.editDoc=function(){var t=s.open({animation:!0,templateUrl:"src/page/form.html",keyboard:!1,controller:"editDocInfoCtrl",backdrop:"static",resolve:{info:function(){return n.documentInfo}}});t.result.then(function(t){},function(t){d()})},n.editApi=function(t){s.open({animation:!0,templateUrl:"src/page/form.html",keyboard:!1,controller:"editApiCtrl",backdrop:"static",resolve:{infos:function(){return n.apis[t]},indexs:function(){return t}}})},n.delApi=function(e){console.log(e),t({url:"delApi",method:"POST",data:{index:e,name:o.docName}}).then(function(t){i.success(t.data.msg),d()},function(t){i.warning(t.data.msg)})}}]).controller("MainController",["$http","$scope",function(t,e){e.docs=[],t({url:"getAllDocs",method:"POST"}).then(function(t){e.docs=t.data.model},function(t){})}]).controller("NewDocumentController",["$scope","$http","toastr","$state",function(t,e,a,o){t.newDocument=function(){e({url:"newDocument",method:"POST",data:t.newDocs}).then(function(t){t.data.status?(a.success(t.data.msg),o.go("home")):a.warning(t.data.msg)},function(t){})}}]).controller("AddApiController",["schemaForm","$scope","toastr","$uibModalInstance","$stateParams","$http",function(t,e,a,o,n,i){e.add_schema={type:"object",properties:{name:{type:"string",required:!0,title:"Name",description:"name for doc"},description:{type:"string",description:"description"},api:{type:"string",title:"Api",required:!0,description:"api"},params:{type:"array",items:{type:"object",properties:{apiName:{type:"string",title:"apiName"},apiValue:{type:"string",title:"apiVlaue"}}}},res:{type:"array",items:{type:"object",properties:{key:{type:"string",title:"key"},revalue:{type:"string",title:"revalue"}}}},demo:{type:"string",title:"demo"}},required:["name","api"]},e.add_form=["*",{type:"submit",title:"save"}],e.add_model={},e.hideModal=function(){o.dismiss()},e.submitAdd=function(t){e.$broadcast("schemaFormValidate"),t.$valid&&t.$dirty?i({url:"addApi",method:"POST",data:{name:n.docName,body:e.add_model}}).then(function(t){t.data.status?(a.success(t.data.msg),o.close(e.add_model)):(a.warning(t.data.msg),o.dismiss())}):a.warning("请把表单填完整后在提交")}}]).controller("delDocumentCtl",["$uibModalInstance","$scope",function(t,e){e.ok=function(){t.close(!0)},e.cancel=function(){t.dismiss()}}]).controller("editDocInfoCtrl",["$scope","$uibModalInstance","$http","info","toastr","$stateParams",function(t,e,a,o,n,i){t.add_schema={type:"object",properties:{name:{type:"string",title:"name"},type:{type:"string",title:"docType"},description:{type:"string",title:"description"}},required:["name","type"]},t.add_form=["name",{key:"type",type:"select",titleMap:{0:"api",1:"sdk"}},{key:"description",type:"textarea"},{type:"submit",title:"save"}],t.hideModal=function(){e.dismiss()},t.add_model=o,t.submitAdd=function(o){t.$broadcast("schemaFormValidate"),o.$valid&&o.$dirty?a({url:"editDocs",method:"POST",data:{name:i.docName,info:t.add_model}}).then(function(a){a.data.status?(n.success(a.data.msg),e.close(t.add_model)):(n.warning(a.data.msg),e.dismiss())}):n.warning("请把表单填完整后在提交")}}]).controller("editApiCtrl",["$scope","infos","indexs","$uibModalInstance","$http","toastr","$stateParams","schemaForm",function(t,e,a,o,n,i,r,s){t.add_model=e,t.add_schema={type:"object",properties:{name:{type:"string",required:!0,title:"Name",description:"name for doc"},description:{type:"string",description:"description"},api:{type:"string",title:"Api",required:!0,description:"api"},params:{type:"array",items:{type:"object",properties:{apiName:{type:"string",title:"apiName"},apiValue:{type:"string",title:"apiVlaue"}}}},res:{type:"array",items:{type:"object",properties:{key:{type:"string",title:"key"},revalue:{type:"string",title:"revalue"}}}},demo:{type:"string",title:"demo"}},required:["name","api"]},t.add_form=["*",{type:"submit",title:"save"}],t.hideModal=function(){o.dismiss()},t.submitAdd=function(e){t.$broadcast("schemaFormValidate"),e.$valid&&e.$dirty?n({url:"editApi",method:"POST",data:{index:a,name:r.docName,api:t.add_model}}).then(function(e){e.data.status?(i.success(e.data.msg),o.close(t.add_model)):(i.warning(e.data.msg),o.dismiss())}):i.warning("请把表单填完整后在提交")}}]),angular.module("app").filter("docType",function(){return function(t){switch(t){case"0":return"api";case"1":return"sdk"}}}),angular.module("app").config(["$stateProvider","$urlRouterProvider",function(t,e){t.state("home",{url:"",templateUrl:"src/page/list.html"}).state("home.doc",{url:"/doc/:docName",views:{"main-container":{templateUrl:"src/page/document.html",controller:"ListController"}}}).state("home.new",{url:"/new",views:{"main-container":{templateUrl:"src/page/newDocument.html",controller:"NewDocumentController"}}});e.otherwise("")}]),angular.module("app").factory("authorInterceptor",["$log","$q","$location",function(t,e,a){var o={request:function(t){return t},response:function(t){return t||e.when(t)},responseError:function(t){return t}};return o}]);