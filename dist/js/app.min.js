"use strict";var app=angular.module("app",["ngAnimate","ui.router","toastr","schemaForm","ui.bootstrap"]).run(function(){console.log("start app")});angular.module("app").config(["$httpProvider","toastrConfig",function(t,e){t.interceptors.push("authorInterceptor"),angular.extend(e,{timeOut:2e3})}]),angular.module("app").controller("ListController",["$http","$anchorScroll","$location","$stateParams","$scope","toastr","$state","$uibModal",function(t,e,o,n,a,r,i,s){function c(){t({url:"getDocument",method:"POST",data:{name:n.docName}}).then(function(t){t.data.status?(a.apis=t.data.model.apis,a.documentInfo=t.data.model.docInfo,a.titles=d(a.apis)):r.warning(t.data.msg)})}function d(t){for(var e=[],o=0;o<t.length;o++)e.push({idx:o,name:t[o].name}),console.log(e);return console.log(e),e}a["goto"]=function(t){o.hash(t),e()},c(),a.addApi=function(){var t=s.open({animation:!0,templateUrl:"src/page/form.html",controller:"AddApiController",keyboard:!1,backdrop:"static"});t.result.then(function(t){c()},function(){})},a.deleteDoc=function(){var e=s.open({animation:!0,templateUrl:"confirm.html",controller:"delDocumentCtl",keyboard:!1,backdrop:"static"});e.result.then(function(e){e&&t({url:"delDocument",method:"POST",data:{name:n.docName}}).then(function(t){t.data.status?(r.success(t.data.msg),i.go("home")):r.warning(t.data.msg)})})},a.editDoc=function(){var t=s.open({animation:!0,templateUrl:"src/page/form.html",keyboard:!1,controller:"editDocInfoCtrl",backdrop:"static",resolve:{info:function(){return a.documentInfo}}});t.result.then(function(t){},function(t){c()})}}]).controller("MainController",["$http","$scope",function(t,e){e.docs=[],t({url:"getAllDocs",method:"POST"}).then(function(t){e.docs=t.data.model},function(t){})}]).controller("NewDocumentController",["$scope","$http","toastr","$state",function(t,e,o,n){t.newDocument=function(){e({url:"newDocument",method:"POST",data:t.newDocs}).then(function(t){t.data.status?(o.success(t.data.msg),n.go("home")):o.warning(t.data.msg)},function(t){})}}]).controller("AddApiController",["schemaForm","$scope","toastr","$uibModalInstance","$stateParams","$http",function(t,e,o,n,a,r){e.add_schema={type:"object",properties:{name:{type:"string",required:!0,title:"Name",description:"name for doc"},description:{type:"string",description:"description"},api:{type:"string",title:"Api",required:!0,description:"api"},params:{type:"array",items:{type:"object",properties:{apiName:{type:"string",title:"apiName"},apiValue:{type:"string",title:"apiVlaue"}}}},res:{type:"array",items:{type:"object",properties:{key:{type:"string",title:"key"},revalue:{type:"string",title:"revalue"}}}},demo:{type:"string",title:"demo"}},required:["name","api"]},e.add_form=["*",{type:"submit",title:"save"}],e.add_model={},e.hideModal=function(){n.dismiss()},e.submitAdd=function(t){e.$broadcast("schemaFormValidate"),t.$valid&&t.$dirty?r({url:"addApi",method:"POST",data:{name:a.docName,body:e.add_model}}).then(function(t){t.data.status?(o.success(t.data.msg),n.close(e.add_model)):(o.warning(t.data.msg),n.dismiss())}):o.warning("请把表单填完整后在提交")}}]).controller("delDocumentCtl",["$uibModalInstance","$scope",function(t,e){e.ok=function(){t.close(!0)},e.cancel=function(){t.dismiss()}}]).controller("editDocInfoCtrl",["$scope","$uibModalInstance","$http","info","toastr","$stateParams",function(t,e,o,n,a,r){t.add_schema={type:"object",properties:{name:{type:"string",title:"name"},type:{type:"string",title:"docType"},description:{type:"string",title:"description"}},required:["name","type"]},t.add_form=["name",{key:"type",type:"select",titleMap:{0:"api",1:"sdk"}},{key:"description",type:"textarea"},{type:"submit",title:"save"}],t.hideModal=function(){e.dismiss()},t.add_model=n,t.submitAdd=function(n){t.$broadcast("schemaFormValidate"),n.$valid&&n.$dirty?o({url:"editDocs",method:"POST",data:{name:r.docName,info:t.add_model}}).then(function(o){o.data.status?(a.success(o.data.msg),e.close(t.add_model)):(a.warning(o.data.msg),e.dismiss())}):a.warning("请把表单填完整后在提交")}}]),angular.module("app").filter("docType",function(){return function(t){switch(t){case"0":return"api";case"1":return"sdk"}}}),angular.module("app").config(["$stateProvider","$urlRouterProvider",function(t,e){t.state("home",{url:"",templateUrl:"src/page/list.html"}).state("home.doc",{url:"/doc/:docName",views:{"main-container":{templateUrl:"src/page/document.html",controller:"ListController"}}}).state("home.new",{url:"/new",views:{"main-container":{templateUrl:"src/page/newDocument.html",controller:"NewDocumentController"}}});e.otherwise("")}]),angular.module("app").factory("authorInterceptor",["$log","$q","$location",function(t,e,o){var n={request:function(t){return t},response:function(t){return t||e.when(t)},responseError:function(t){return t}};return n}]);