"use strict";var app=angular.module("app",["ngAnimate","ui.router","toastr","ui.bootstrap"]).run(function(){console.log("start app")});angular.module("app").config(["$httpProvider","toastrConfig","$locationProvider",function(t,e,a){t.interceptors.push("authorInterceptor"),a.html5Mode({enabled:!0,requireBase:!0}),angular.extend(e,{timeOut:2e3})}]),angular.module("app").controller("ListController",["$http","$anchorScroll","$location","$stateParams","$scope","toastr","$state","$uibModal",function(t,e,a,n,o,r,i,s){function d(){t({url:"getAllDocs",method:"POST"}).then(function(t){o.docs=t.data.model,c()},function(t){})}function c(){o.docs.forEach(function(e){t({url:"getDocument",method:"POST",data:{name:e.name}}).then(function(t){t.data.status?(o.apis=t.data.model.apis,e.apiList=l(o.apis)):r.warning(t.data.msg)})})}function l(t){for(var e=[],a=0;a<t.length;a++)e.push({idx:a,name:t[a].name});return e}o.docs=[],o["goto"]=function(t){a.hash(t),e()},d()}]).controller("MainController",["$http","$scope","$stateParams","toastr","$state","$uibModal",function(t,e,a,n,o,r){e.apis=[],t({url:"getDocument",method:"POST",data:{name:a.docName}}).then(function(t){t.data.status?(e.apis.push(t.data.model.apis[a.apiIndex]),e.documentInfo=t.data.model.docInfo,console.log(e.documentInfo),e.documentInfo.index=a.apiIndex):n.warning(t.data.msg)}),e.delApi=function(e,i){var s=r.open({animation:!0,templateUrl:"confirm.html",controller:"delDocumentCtl",keyboard:!1,backdrop:"static"});s.result.then(function(e){e?t({url:"delApi",method:"POST",data:{index:a.apiIndex,name:i}}).then(function(t){n.success(t.data.msg),o.transitionTo("home.doc",{docName:a.docName,apiIndex:0},{reload:!0})},function(t){n.warning(t.data.msg)}):console.log("dismiss")})}}]).controller("NewDocumentController",["$scope","$http","toastr","$state",function(t,e,a,n){t.newDocument=function(){e({url:"newDocument",method:"POST",data:t.newDocs}).then(function(t){t.data.status?(a.success(t.data.msg),n.transitionTo("home.doc",{docName:$stateParams.docName,apiIndex:0},{reload:!0})):a.warning(t.data.msg)},function(t){})}}]).controller("AddApiController",["$scope","toastr","$stateParams","$http","$state",function(t,e,a,n,o){t.newApi={params:[],res:[]},t.addApi=function(r){r.$valid?n({url:"addApi",method:"POST",data:{name:a.docName,body:t.newApi}}).then(function(t){t.data.status?(e.success(t.data.msg),o.transitionTo("home.doc",{docName:a.docName,apiIndex:0},{reload:!0})):e.warning(t.data.msg)}):e.warning("请把表单填完整后在提交")}}]).controller("editApiCtrl",["$scope","$http","toastr","$uibModal","$stateParams","$state",function(t,e,a,n,o,r){e({url:"getDocument",method:"POST",data:{name:o.docName}}).then(function(e){e.data.status?(t.apis=e.data.model.apis[o.apiIndex],t.documentInfo=e.data.model.docInfo):a.warning(e.data.msg)}),t.submitAdd=function(n){n.$valid?e({url:"editApi",method:"POST",data:{index:o.apiIndex,name:o.docName,api:t.apis}}).then(function(t){t.data.status?(a.success(t.data.msg),r.transitionTo("home.doc",{docName:o.docName,apiIndex:0},{reload:!0})):a.warning(t.data.msg)}):a.warning("请把表单填完整后在提交")}}]),angular.module("app").directive("onFormReady",["$timeout",function(t){return{restrict:"A",link:function(t,e,a){t.addParams=function(e){var a={apiName:"",apiValue:"",type:""};t.apis.params.push(a)},t.addRes=function(e){var a={key:"",revalue:"",type:""};t.apis.res.push(a)},t.delParam=function(e){t.apis.params.splice(e,1)},t.delRes=function(e){t.apis.res.splice(e,1)}}}}]).directive("onNewFormReady",["$timeout",function(t){return{restrict:"A",link:function(t,e,a){t.addParams=function(e){var a={apiName:"",apiValue:"",type:""};t.newApi.params.push(a)},t.addRes=function(e){var a={key:"",revalue:"",type:""};t.newApi.res.push(a)},t.delParam=function(e){t.newApi.params.splice(e,1)},t.delRes=function(e){t.newApi.res.splice(e,1)}}}}]),angular.module("app").filter("docType",function(){return function(t){switch(t){case"0":return"api";case"1":return"sdk"}}}),angular.module("app").config(["$stateProvider","$urlRouterProvider",function(t,e){t.state("home",{url:"/",templateUrl:"src/page/list.html",controller:"ListController"}).state("home.doc",{url:":docName/:apiIndex",views:{apiContent:{templateUrl:"src/page/document.html",controller:"MainController"}}}).state("home.edit",{url:":docName/:apiIndex/edit",views:{apiContent:{templateUrl:"src/page/form.html",controller:"editApiCtrl"}}}).state("home.new",{url:"new",views:{"main-container":{templateUrl:"src/page/newDocument.html",controller:"NewDocumentController"}}}).state("home.newApi",{url:":docName/:apiIndex/newApi",views:{apiContent:{templateUrl:"src/page/newApi.html",controller:"AddApiController"}}});e.otherwise("/")}]),angular.module("app").factory("authorInterceptor",["$log","$q","$location",function(t,e,a){var n={request:function(t){return t},response:function(t){return t||e.when(t)},responseError:function(t){return t}};return n}]);